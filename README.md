# wb-relevant-positions-parser

Консольная утилита для поиска текущий позиции товара Wildberries в поисковой выдаче по ключевым фразам, выделенным из описания товара.

## Принцип работы
- Эмулируется открытие страницы товара через Selenium
- Парсится описание товара
- Выделяются поисковые фразы на основе описания через OpenAI
- Открывается страница с поиском по каждой фразе и определяется позиция указанного товара

## Используемые технологии
- selenium
- openai

## Установка и запуск
Проект тестировался на Python 3.11.11.

1. Клонируйте репозиторий:
```bash
git clone https://github.com/tgaru/wb-relevant-positions-parser.git
cd wb-relevant-positions-parser/
```

2. Создайте и активируйте виртуальное окружение:
```bash
python -m venv .venv
source .venv/bin/activate  # для Linux/Mac
# или
.venv\Scripts\activate  # для Windows
```

3. Установите зависимости:
```bash
pip install -r requirements.txt
```

4. Создайте и заполните файл `.env`
```dotenv
OPENAI_API_KEY=
```

5. Запустите главный скрипт:
```bash
python main.py
# Введите URL товара WB: ...
```

## Ограничения
В данной реализации не предусмотренна прокрутка страницы поиска, поэтому поиск позиции ведётся только среди первых 10 товаров в выдаче.

Промпт для поиска ключевых фраз EXTRACT_KEYWORDS_PROMPT является тестовым и может выделять смысл из описания не корректно.

## Использование
Запуск поиска позиций:
```python
result = find_relevant_positions(
    product_url='https://www.wildberries.ru/catalog/...',
    keywords_count=5,
    show_browser=False
)
pprint(result)
```

## Выделение ключевых фраз
Для выделения ключевых фраз используется промпт из константы EXTRACT_KEYWORDS_PROMPT файла `config/prompts.py`.

## Пример работы
Название товара: Подшипники ABEC для самоката, подшипник

Ссылка на товар: https://www.wildberries.ru/catalog/113507080/detail.aspx

Результат:
```json
{
  'url': 'https://www.wildberries.ru/catalog/113507080/detail.aspx',
  'description': 'Набор подшипников в тубе 10 штук.Подходят подшипники для '
                 'самокатов, скейтов, скейтбордов, лыжероллеров, роликовых '
                 'коньков, колес тачки, коляски, электроприборов и '
                 'др.Представлены три вида. Подшипник АБЕС-7, 608ZZ цвет '
                 'металл. Подшипник АБЕС-9, 608RS цвет металл с зелеными или '
                 'красными пыльниками, в зависимости от поставки. Подшипник '
                 'АБЕС-12, 608RS цвет металл с черными пыльниками.Внутренний '
                 'диаметр 8 мм. Наружный диаметр 22 мм. Ширина (высота) 7 мм. '
                 'Ширина наружной обоймы 7 мм.Нет необходимости смазывать, так '
                 'как идет заводская смазка, что продлевает срок службы.\n'
                 'ABEC - это показатель, который показывает качество '
                 'изготовления и полировки подшипника, а не то, как долго '
                 'колесо вращается на оси.\n'
                 '\n'
                 'Чем больше число ABEC - тем выше точность изготовления. '
                 'Подшипники выпускаются с определенной точностью. Повышенный '
                 'класс точности позволяет подшипнику вращаться при большей '
                 'частоте с меньшей вибрацией и трением. Разогнавшись до '
                 'приличной скорости, вы не почувствуете разницы.',
  'keywords': ['набор подшипников',
               'подшипник АБЕС-7',
               'подшипник АБЕС-9',
               'подшипник АБЕС-12',
               'подшипник для самоката'],
  'positions': [{'keyword': 'набор подшипников', 'position': 0},
                {'keyword': 'подшипник АБЕС-7', 'position': 0},
                {'keyword': 'подшипник АБЕС-9', 'position': 0},
                {'keyword': 'подшипник АБЕС-12', 'position': 6},
                {'keyword': 'подшипник для самоката', 'position': 2}]
}
```